"use strict";(()=>{var Ve=()=>!0,x=class{constructor(n,e,t){this.root=n,this.currentNode=n,this.nodeType=e,this.filter=t||Ve}isAcceptableNode(n){let e=n.nodeType;return!!((e===Node.ELEMENT_NODE?1:e===Node.TEXT_NODE?4:0)&this.nodeType)&&this.filter(n)}nextNode(){let n=this.root,e=this.currentNode,t;for(;;){for(t=e.firstChild;!t&&e&&e!==n;)t=e.nextSibling,t||(e=e.parentNode);if(!t)return null;if(this.isAcceptableNode(t))return this.currentNode=t,t;e=t}}previousNode(){let n=this.root,e=this.currentNode,t;for(;;){if(e===n)return null;if(t=e.previousSibling,t)for(;e=t.lastChild;)t=e;else t=e.parentNode;if(!t)return null;if(this.isAcceptableNode(t))return this.currentNode=t,t;e=t}}previousPONode(){let n=this.root,e=this.currentNode,t;for(;;){for(t=e.lastChild;!t&&e&&e!==n;)t=e.previousSibling,t||(e=e.parentNode);if(!t)return null;if(this.isAcceptableNode(t))return this.currentNode=t,t;e=t}}};var B="\u200B",M=/[^ \t\r\n]/,R={};function Q(){if(!R.init){let o=R.ua=navigator.userAgent;R.isMac=/Mac OS X/.test(o),R.isLegacyEdge=/Edge\//.test(o),R.isWin=/Windows NT/.test(o),R.isAndroid=/Android/.test(o),R.isGecko=/Gecko\//.test(o),R.init=!0,R.cantFocusEmptyTextNodes=R.isWebKit=!R.isLegacyEdge&&/WebKit\//.test(o),R.isIOS=/iP(?:ad|hone|od)/.test(o)||R.isMac&&!!navigator.maxTouchPoints,R.ctrlKey=R.isMac||R.isIOS?"Meta-":"Ctrl-",R.supportsInputEvents="onbeforeinput"in document&&"inputType"in new InputEvent("input")}return R}var et=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:FRAME|MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|TIME|U|VAR|WBR)$/,tt=new Set(["BR","HR","IFRAME","IMG","INPUT"]),nt=0,Se=1,Ae=2,De=3,ae=new WeakMap,we=()=>{ae=new WeakMap},H=o=>tt.has(o.nodeName),Te=o=>{switch(o.nodeType){case 3:return Se;case 1:case 11:if(ae.has(o))return ae.get(o);break;default:return nt}let n;return Array.from(o.childNodes).every(g)?et.test(o.nodeName)?n=Se:n=Ae:n=De,ae.set(o,n),n},g=o=>Te(o)===Se,q=o=>Te(o)===Ae,$=o=>Te(o)===De;var N=(o,n,e)=>{let t=document.createElement(o);if(n instanceof Array&&(e=n,n=null),n)for(let i in n){let s=n[i];s!==void 0&&t.setAttribute(i,s)}return e&&e.forEach(i=>t.appendChild(i)),t},Ce=(o,n)=>H(o)||o.nodeType!==n.nodeType||o.nodeName!==n.nodeName?!1:o instanceof HTMLElement&&n instanceof HTMLElement?o.nodeName!=="A"&&o.className===n.className&&o.style.cssText===n.style.cssText:!0,ce=(o,n,e)=>{if(o.nodeName!==n)return!1;for(let t in e)if(!("getAttribute"in o)||o.getAttribute(t)!==e[t])return!1;return!0},S=(o,n,e,t)=>{for(;o&&o!==n;){if(ce(o,e,t))return o;o=o.parentNode}return null},de=(o,n)=>{let e=o.childNodes;for(;n&&o instanceof Element;)o=e[n-1],e=o.childNodes,n=e.length;return o},xe=(o,n)=>{let e=o;if(e instanceof Element){let t=e.childNodes;if(n<t.length)e=t[n];else{for(;e&&!e.nextSibling;)e=e.parentNode;e&&(e=e.nextSibling)}}return e},y=o=>o instanceof Element||o instanceof DocumentFragment?o.childNodes.length:o instanceof CharacterData?o.length:0,T=o=>{let n=document.createDocumentFragment(),e=o.firstChild;for(;e;)n.appendChild(e),e=o.firstChild;return n},E=o=>{let n=o.parentNode;return n&&n.removeChild(o),o},O=(o,n)=>{let e=o.parentNode;e&&e.replaceChild(n,o)};var ot=o=>o instanceof Element?o.nodeName==="BR":M.test(o.data),te=(o,n)=>{let e=o.parentNode;for(;g(e);)e=e.parentNode;let t=new x(e,5,ot);return t.currentNode=o,!!t.nextNode()||n&&!t.previousNode()},ie=(o,n)=>{let e=new x(o,4),t,i;for(;t=e.nextNode();)for(;(i=t.data.indexOf(B))>-1&&(!n||t.parentNode!==n);)if(t.length===1){let s=t,r=s.parentNode;for(;r&&(r.removeChild(s),e.currentNode=r,!(!g(r)||y(r)));)s=r,r=s.parentNode;break}else t.deleteData(i,1)};var it=0,st=1,rt=2,lt=3,z=(o,n,e)=>{let t=document.createRange();if(t.selectNode(n),e){let i=o.compareBoundaryPoints(lt,t)>-1,s=o.compareBoundaryPoints(st,t)<1;return!i&&!s}else{let i=o.compareBoundaryPoints(it,t)<1,s=o.compareBoundaryPoints(rt,t)>-1;return i&&s}},C=o=>{let{startContainer:n,startOffset:e,endContainer:t,endOffset:i}=o;for(;!(n instanceof Text);){let s=n.childNodes[e];if(!s||H(s)){if(e&&(s=n.childNodes[e-1],s instanceof Text)){let r=s,a;for(;!r.length&&(a=r.previousSibling)&&a instanceof Text;)r.remove(),r=a;n=r,e=r.data.length}break}n=s,e=0}if(i)for(;!(t instanceof Text);){let s=t.childNodes[i-1];if(!s||H(s)){if(s&&s.nodeName==="BR"&&!te(s,!1)){i-=1;continue}break}t=s,i=y(t)}else for(;!(t instanceof Text);){let s=t.firstChild;if(!s||H(s))break;t=s}o.setStart(n,e),o.setEnd(t,i)},W=(o,n,e,t)=>{let i=o.startContainer,s=o.startOffset,r=o.endContainer,a=o.endOffset,l;for(n||(n=o.commonAncestorContainer),e||(e=n);!s&&i!==n&&i!==t;)l=i.parentNode,s=Array.from(l.childNodes).indexOf(i),i=l;for(;!(r===e||r===t||(r.nodeType!==3&&r.childNodes[a]&&r.childNodes[a].nodeName==="BR"&&!te(r.childNodes[a],!1)&&(a+=1),a!==y(r)));)l=r.parentNode,a=Array.from(l.childNodes).indexOf(r)+1,r=l;o.setStart(i,s),o.setEnd(r,a)},_e=(o,n,e)=>{let t=S(o.endContainer,e,n);if(t&&(t=t.parentNode)){let i=o.cloneRange();W(i,t,t,e),i.endContainer===t&&(o.setStart(i.endContainer,i.endOffset),o.setEnd(i.endContainer,i.endOffset))}return o};var v=o=>{let{cantFocusEmptyTextNodes:n}=Q(),e=null;if(o instanceof Text)return o;if(g(o)){let t=o.firstChild;if(n)for(;t&&t instanceof Text&&!t.data;)o.removeChild(t),t=o.firstChild;t||(n?e=document.createTextNode(B):e=document.createTextNode(""))}else if((o instanceof Element||o instanceof DocumentFragment)&&!o.querySelector("BR")){e=N("BR");let t=o,i;for(;(i=t.lastElementChild)&&!g(i);)t=i;o=t}if(e)try{o.appendChild(e)}catch(t){}return o},A=(o,n)=>{let e=null;return Array.from(o.childNodes).forEach(t=>{let i=t.nodeName==="BR";!i&&g(t)?(e||(e=N("DIV")),e.appendChild(t)):(i||e)&&(e||(e=N("DIV")),v(e),i?o.replaceChild(e,t):o.insertBefore(e,t),e=null),$(t)&&A(t,n)}),e&&o.appendChild(v(e)),o},w=(o,n,e,t)=>{if(o instanceof Text&&o!==e){if(typeof n!="number")throw new Error("Offset must be a number to split text node!");if(!o.parentNode)throw new Error("Cannot split text node with no parent!");return w(o.parentNode,o.splitText(n),e,t)}let i=typeof n=="number"?n<o.childNodes.length?o.childNodes[n]:null:n,s=o.parentNode;if(!s||o===e||!(o instanceof Element))return i;let r=o.cloneNode(!1);for(;i;){let a=i.nextSibling;r.appendChild(i),i=a}return o instanceof HTMLOListElement&&S(o,t,"BLOCKQUOTE")&&(r.start=(+o.start||1)+o.childNodes.length-1),v(o),v(r),s.insertBefore(r,o.nextSibling),w(s,r,e,t)},Ie=(o,n)=>{let e=o.childNodes,t=e.length,i=[];for(;t--;){let s=e[t],r=t?e[t-1]:null;if(r&&g(s)&&Ce(s,r))n.startContainer===s&&(n.startContainer=r,n.startOffset+=y(r)),n.endContainer===s&&(n.endContainer=r,n.endOffset+=y(r)),n.startContainer===o&&(n.startOffset>t?n.startOffset-=1:n.startOffset===t&&(n.startContainer=r,n.startOffset=y(r))),n.endContainer===o&&(n.endOffset>t?n.endOffset-=1:n.endOffset===t&&(n.endContainer=r,n.endOffset=y(r))),E(s),s instanceof Text?r.appendData(s.data):i.push(T(s));else if(s instanceof Element){let a;for(;a=i.pop();)s.appendChild(a);Ie(s,n)}}},ne=(o,n)=>{let e=o instanceof Text?o.parentNode:o;if(e instanceof Element){let t={startContainer:n.startContainer,startOffset:n.startOffset,endContainer:n.endContainer,endOffset:n.endOffset};Ie(e,t),n.setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset)}},ee=(o,n,e,t)=>{let i=n,s,r;for(;(s=i.parentNode)&&s!==t&&s instanceof Element&&s.childNodes.length===1;)i=s;E(i),r=o.childNodes.length;let a=o.lastChild;a&&a.nodeName==="BR"&&(o.removeChild(a),r-=1),o.appendChild(T(n)),e.setStart(o,r),e.collapse(!0),ne(o,e)},F=(o,n)=>{let e=o.previousSibling,t=o.firstChild,i=o.nodeName==="LI";if(!(i&&(!t||!/^[OU]L$/.test(t.nodeName)))){if(e&&Ce(e,o)){if(!$(e))if(i){let r=N("DIV");r.appendChild(T(e)),e.appendChild(r)}else return;E(o);let s=!$(o);e.appendChild(T(o)),s&&A(e,n),t&&F(t,n)}else if(i){let s=N("DIV");o.insertBefore(s,t),v(s)}}};var Me={"font-weight":{regexp:/^bold|^700/i,replace(){return N("B")}},"font-style":{regexp:/^italic/i,replace(){return N("I")}},"font-family":{regexp:M,replace(o,n){return N("SPAN",{class:o.fontFamily,style:"font-family:"+n})}},"font-size":{regexp:M,replace(o,n){return N("SPAN",{class:o.fontSize,style:"font-size:"+n})}},"text-decoration":{regexp:/^underline/i,replace(){return N("U")}}},at=(o,n,e)=>{let t=o.style,i,s;for(let r in Me){let a=Me[r],l=t.getPropertyValue(r);if(l&&a.regexp.test(l)){let d=a.replace(e.classNames,l);if(d.nodeName===o.nodeName&&d.className===o.className)continue;s||(s=d),i&&i.appendChild(d),i=d,o.style.removeProperty(r)}}return s&&i&&(i.appendChild(T(o)),o.style.cssText?o.appendChild(s):O(o,s)),i||o},fe=o=>(n,e)=>{let t=N(o),i=n.attributes;for(let s=0,r=i.length;s<r;s+=1){let a=i[s];t.setAttribute(a.name,a.value)}return e.replaceChild(t,n),t.appendChild(T(n)),t},ct={1:"10",2:"13",3:"16",4:"18",5:"24",6:"32",7:"48"},dt={STRONG:fe("B"),EM:fe("I"),INS:fe("U"),STRIKE:fe("S"),SPAN:at,FONT:(o,n,e)=>{let t=o,i=t.face,s=t.size,r=t.color,a=e.classNames,l,d,c,u,f;return i&&(l=N("SPAN",{class:a.fontFamily,style:"font-family:"+i}),f=l,u=l),s&&(d=N("SPAN",{class:a.fontSize,style:"font-size:"+ct[s]+"px"}),f||(f=d),u&&u.appendChild(d),u=d),r&&/^#?([\dA-F]{3}){1,2}$/i.test(r)&&(r.charAt(0)!=="#"&&(r="#"+r),c=N("SPAN",{class:a.color,style:"color:"+r}),f||(f=c),u&&u.appendChild(c),u=c),(!f||!u)&&(f=u=N("SPAN")),n.replaceChild(f,t),u.appendChild(T(t)),u},TT:(o,n,e)=>{let t=N("SPAN",{class:e.classNames.fontFamily,style:'font-family:menlo,consolas,"courier new",monospace'});return n.replaceChild(t,o),t.appendChild(T(o)),t}},ft=/^(?:A(?:DDRESS|RTICLE|SIDE|UDIO)|BLOCKQUOTE|CAPTION|D(?:[DLT]|IV)|F(?:IGURE|IGCAPTION|OOTER)|H[1-6]|HEADER|L(?:ABEL|EGEND|I)|O(?:L|UTPUT)|P(?:RE)?|SECTION|T(?:ABLE|BODY|D|FOOT|H|HEAD|R)|COL(?:GROUP)?|UL)$/,ut=/^(?:HEAD|META|STYLE)/,ue=(o,n,e)=>{let t=o.childNodes,i=o;for(;g(i);)i=i.parentNode;let s=new x(i,5);for(let r=0,a=t.length;r<a;r+=1){let l=t[r],d=l.nodeName,c=dt[d];if(l instanceof HTMLElement){let u=l.childNodes.length;if(c)l=c(l,o,n);else if(ut.test(d)){o.removeChild(l),r-=1,a-=1;continue}else if(!ft.test(d)&&!g(l)){r-=1,a+=u-1,o.replaceChild(T(l),l);continue}u&&ue(l,n,e||d==="PRE")}else{if(l instanceof Text){let u=l.data,f=!M.test(u.charAt(0)),m=!M.test(u.charAt(u.length-1));if(e||!f&&!m)continue;if(f){s.currentNode=l;let p;for(;(p=s.previousPONode())&&!(p.nodeName==="IMG"||p instanceof Text&&M.test(p.data));)if(!g(p)){p=null;break}u=u.replace(/^[ \t\r\n]+/g,p?" ":"")}if(m){s.currentNode=l;let p;for(;(p=s.nextNode())&&!(p.nodeName==="IMG"||p instanceof Text&&M.test(p.data));)if(!g(p)){p=null;break}u=u.replace(/[ \t\r\n]+$/g,p?" ":"")}if(u){l.data=u;continue}}o.removeChild(l),r-=1,a-=1}}return o},he=o=>{let n=o.childNodes,e=n.length;for(;e--;){let t=n[e];t instanceof Element&&!H(t)?(he(t),g(t)&&!t.firstChild&&o.removeChild(t)):t instanceof Text&&!t.data&&o.removeChild(t)}},se=(o,n,e)=>{let t=o.querySelectorAll("BR"),i=[],s=t.length;for(let r=0;r<s;r+=1)i[r]=te(t[r],e);for(;s--;){let r=t[s],a=r.parentNode;a&&(i[s]?g(a)||A(a,n):E(r))}},ve=o=>o.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;");var re=(o,n)=>{let e=new x(n,1,q);return e.currentNode=o,e},G=(o,n)=>{let e=re(o,n).previousNode();return e!==n?e:null},K=(o,n)=>{let e=re(o,n).nextNode();return e!==n?e:null},le=o=>!o.textContent&&!o.querySelector("IMG");var L=(o,n)=>{let e=o.startContainer,t;if(g(e))t=G(e,n);else if(e!==n&&e instanceof HTMLElement&&q(e))t=e;else{let i=de(e,o.startOffset);t=K(i,n)}return t&&z(o,t,!0)?t:null},Z=(o,n)=>{let e=o.endContainer,t;if(g(e))t=G(e,n);else if(e!==n&&e instanceof HTMLElement&&q(e))t=e;else{let i=xe(e,o.endOffset);if(!i||!n.contains(i)){i=n;let s;for(;s=i.lastChild;)i=s}t=G(i,n)}return t&&z(o,t,!0)?t:null},He=o=>o instanceof Text?M.test(o.data):o.nodeName==="IMG",V=(o,n)=>{let e=o.startContainer,t=o.startOffset,i;if(e instanceof Text){let a=e.data;for(let l=t;l>0;l-=1)if(a.charAt(l-1)!==B)return!1;i=e}else if(i=xe(e,t),i&&!n.contains(i)&&(i=null),!i&&(i=de(e,t),i instanceof Text&&i.length))return!1;let s=L(o,n);if(!s)return!1;let r=new x(s,5,He);return r.currentNode=i,!r.previousNode()},j=(o,n)=>{let e=o.endContainer,t=o.endOffset,i;if(e instanceof Text){let a=e.data,l=a.length;for(let d=t;d<l;d+=1)if(a.charAt(d)!==B)return!1;i=e}else i=de(e,t);let s=Z(o,n);if(!s)return!1;let r=new x(s,5,He);return r.currentNode=i,!r.nextNode()},be=(o,n)=>{let e=L(o,n),t=Z(o,n),i;e&&t&&(i=e.parentNode,o.setStart(i,Array.from(i.childNodes).indexOf(e)),i=t.parentNode,o.setEnd(i,Array.from(i.childNodes).indexOf(t)+1))};function Y(o,n,e,t){let i=document.createRange();return i.setStart(o,n),e&&typeof t=="number"?i.setEnd(e,t):i.setEnd(o,n),i}var X=(o,n)=>{let{startContainer:e,startOffset:t,endContainer:i,endOffset:s}=o,r;if(e instanceof Text){let l=e.parentNode;if(r=l.childNodes,t===e.length)t=Array.from(r).indexOf(e)+1,o.collapsed&&(i=l,s=t);else{if(t){let d=e.splitText(t);i===e?(s-=t,i=d):i===l&&(s+=1),e=d}t=Array.from(r).indexOf(e)}e=l}else r=e.childNodes;let a=r.length;t===a?e.appendChild(n):e.insertBefore(n,r[t]),e===i&&(s+=r.length-a),o.setStart(e,t),o.setEnd(i,s)},Le=(o,n,e)=>{let t=document.createDocumentFragment();if(o.collapsed)return t;n||(n=o.commonAncestorContainer),n instanceof Text&&(n=n.parentNode);let i=o.startContainer,s=o.startOffset,r=w(o.endContainer,o.endOffset,n,e),a=0,l=w(i,s,n,e);for(;l&&l!==r;){let d=l.nextSibling;t.appendChild(l),l=d}return l=r&&r.previousSibling,l&&l instanceof Text&&r instanceof Text&&(a=l.length,l.appendData(r.data),E(r),r=l),o.setStart(i,s),r?o.setEnd(r,a):o.setEnd(n,n.childNodes.length),v(n),t},Fe=(o,n,e)=>{o.currentNode=e;let t;for(;t=o[n]();){if(t instanceof Text||H(t))return t;if(!g(t))return null}return null},P=(o,n)=>{let e=L(o,n),t=Z(o,n),i=e!==t;e&&t&&(C(o),W(o,e,t,n));let s=Le(o,null,n);C(o),i&&(t=Z(o,n),e&&t&&e!==t&&ee(e,t,o,n)),e&&v(e);let r=n.firstChild;(!r||r.nodeName==="BR")&&(v(n),n.firstChild&&o.selectNodeContents(n.firstChild)),o.collapse(!0);let a=o.startContainer,l=o.startOffset,d=new x(n,5),c=a,u=l;(!(c instanceof Text)||u===c.data.length)&&(c=Fe(d,"nextNode",c),u=0);let f=a,m=l-1;(!(f instanceof Text)||m===-1)&&(f=Fe(d,"previousPONode",c||(a instanceof Text?a:a.childNodes[l]||a)),f instanceof Text&&(m=f.data.length));let p=null,h=0;return c instanceof Text&&c.data.charAt(u)===" "&&V(o,n)?(p=c,h=u):f instanceof Text&&f.data.charAt(m)===" "&&(c instanceof Text&&c.data.charAt(u)===" "||j(o,n))&&(p=f,h=m),p&&p.replaceData(h,1,"\xA0"),o.setStart(a,l),o.collapse(!0),s},Pe=(o,n,e)=>{let t=n.firstChild&&g(n.firstChild),i;for(A(n,e),i=n;i=K(i,e);)v(i);o.collapsed||P(o,e),C(o),o.collapse(!1);let s=S(o.endContainer,e,"BLOCKQUOTE")||e,r=L(o,e),a=null,l=K(n,n),d=!t&&!!r&&le(r);if(r&&l&&!d&&!S(l,n,"PRE")&&!S(l,n,"TABLE")){W(o,r,r,e),o.collapse(!0);let c=o.endContainer,u=o.endOffset;if(se(r,e,!1),g(c)){let f=w(c,u,G(c,e)||e,e);c=f.parentNode,u=Array.from(c.childNodes).indexOf(f)}if(u!==y(c))for(a=document.createDocumentFragment();i=c.childNodes[u];)a.appendChild(i);ee(c,l,o,e),u=Array.from(c.parentNode.childNodes).indexOf(c)+1,c=c.parentNode,o.setEnd(c,u)}if(y(n)){d&&r&&(o.setEndBefore(r),o.collapse(!1),E(r)),W(o,s,s,e);let c=w(o.endContainer,o.endOffset,s,e),u=c?c.previousSibling:s.lastChild;s.insertBefore(n,c),c?o.setEndBefore(c):o.setEnd(s,y(s)),r=Z(o,e),C(o);let f=o.endContainer,m=o.endOffset;c&&$(c)&&F(c,e),c=u&&u.nextSibling,c&&$(c)&&F(c,e),o.setEnd(f,m)}if(a&&r){let c=o.cloneRange();v(a),ee(r,a,c,e),o.setEnd(c.endContainer,c.endOffset)}C(o)};var me=o=>{if(o.collapsed)return"";let n=o.startContainer,e=o.endContainer,t=new x(o.commonAncestorContainer,5,l=>z(o,l,!0));t.currentNode=n;let i=n,s="",r=!1,a;for((!(i instanceof Element)&&!(i instanceof Text)||!t.filter(i))&&(i=t.nextNode());i;)i instanceof Text?(a=i.data,a&&/\S/.test(a)&&(i===e&&(a=a.slice(0,o.endOffset)),i===n&&(a=a.slice(o.startOffset)),s+=a,r=!0)):(i.nodeName==="BR"||r&&!g(i))&&(s+=`
`,r=!1),i=t.nextNode();return s=s.replace(/ /g," "),s};var Re=Array.prototype.indexOf,qe=(o,n,e,t,i,s,r)=>{let{isLegacyEdge:a,isWin:l}=Q(),d=o.clipboardData;if(a||!d)return!1;let c=s?"":me(n),u=L(n,e),f=Z(n,e),m=e;u===f&&(u!=null&&u.contains(n.commonAncestorContainer))&&(m=u);let p;t?p=P(n,e):(n=n.cloneRange(),C(n),W(n,m,m,e),p=n.cloneContents());let h=n.commonAncestorContainer;for(h instanceof Text&&(h=h.parentNode);h&&h!==m;){let _=h.cloneNode(!1);_.appendChild(p),p=_,h=h.parentNode}let b;if(p.childNodes.length===1&&p.childNodes[0]instanceof Text)c=p.childNodes[0].data.replace(/ /g," "),r=!0;else{let _=N("DIV");_.appendChild(p),b=_.innerHTML,i&&(b=i(b))}return s&&b!==void 0&&(c=s(b)),l&&(c=c.replace(/\r?\n/g,`\r
`)),!r&&b&&c!==b&&(b="<!-- squire -->"+b,d.setData("text/html",b)),d.setData("text/plain",c),o.preventDefault(),!0},Ue=function(o){let n=this.getSelection(),e=this._root;if(n.collapsed){o.preventDefault();return}this.saveUndoState(n),qe(o,n,e,!0,this._config.willCutCopy,this._config.toPlainText,!1)||setTimeout(()=>{try{this._ensureBottomLine()}catch(i){this._config.didError(i)}},0),this.setSelection(n)},We=function(o){qe(o,this.getSelection(),this._root,!1,this._config.willCutCopy,this._config.toPlainText,!1)},Oe=function(o){this._isShiftDown=o.shiftKey},Ke=function(o){let{isLegacyEdge:n,isGecko:e}=Q(),t=o.clipboardData,i=t==null?void 0:t.items,s=this._isShiftDown,r=!1,a=!1,l=null,d=null;if(i){let k=i.length;for(;k--;){let I=i[k],D=I.type;D==="text/html"?d=I:D==="text/plain"||D==="text/uri-list"?l=I:D==="text/rtf"?r=!0:/^image\/.*/.test(D)&&(a=!0)}if(a&&!(r&&d)){o.preventDefault(),this.fireEvent("pasteImage",{clipboardData:t});return}if(!n){o.preventDefault(),d&&(!s||!l)?d.getAsString(I=>{this.insertHTML(I,!0)}):l&&l.getAsString(I=>{let D=!1,ye=this.getSelection();if(!ye.collapsed&&M.test(ye.toString())){let Be=this.linkRegExp.exec(I);D=!!Be&&Be[0].length===I.length}D?this.makeLink(I):this.insertPlainText(I,!0)});return}}let c=t==null?void 0:t.types;if(!n&&c&&(Re.call(c,"text/html")>-1||!e&&Re.call(c,"text/plain")>-1&&Re.call(c,"text/rtf")<0)){o.preventDefault();let k;!s&&(k=t.getData("text/html"))?this.insertHTML(k,!0):((k=t.getData("text/plain"))||(k=t.getData("text/uri-list")))&&this.insertPlainText(k,!0);return}let u=document.body,f=this.getSelection(),m=f.startContainer,p=f.startOffset,h=f.endContainer,b=f.endOffset,_=N("DIV",{contenteditable:"true",style:"position:fixed; overflow:hidden; top:0; right:100%; width:1px; height:1px;"});u.appendChild(_),f.selectNodeContents(_),this.setSelection(f),setTimeout(()=>{try{let k="",I=_,D;for(;_=I;)I=_.nextSibling,E(_),D=_.firstChild,D&&D===_.lastChild&&D instanceof HTMLDivElement&&(_=D),k+=_.innerHTML;this.setSelection(Y(m,p,h,b)),k&&this.insertHTML(k,!0)}catch(k){this._config.didError(k)}},0)},ze=function(o){if(!o.dataTransfer)return;let n=o.dataTransfer.types,e=n.length,t=!1,i=!1;for(;e--;)switch(n[e]){case"text/plain":t=!0;break;case"text/html":i=!0;break;default:return}(i||t&&this.saveUndoState)&&this.saveUndoState()};var ke=(o,n,e)=>{n.preventDefault(),o.splitBlock(n.shiftKey,e)};var oe=(o,n)=>{try{n||(n=o.getSelection());let e=n.startContainer;e instanceof Text&&(e=e.parentNode);let t=e;for(;g(t)&&(!t.textContent||t.textContent===B);)e=t,t=e.parentNode;e!==t&&(n.setStart(t,Array.from(t.childNodes).indexOf(e)),n.collapse(!0),t.removeChild(e),q(t)||(t=G(t,o._root)||o._root),v(t),C(n)),e===o._root&&(e=e.firstChild)&&e.nodeName==="BR"&&E(e),o._ensureBottomLine(),o.setSelection(n),o._updatePath(n,!0)}catch(e){o._config.didError(e)}},pe=(o,n)=>{let e;for(;(e=o.parentNode)&&!(e===n||e.isContentEditable);)o=e;E(o)},Ne=(o,n,e)=>{if(S(n,o._root,"A"))return;let t=n.data||"",i=Math.max(t.lastIndexOf(" ",e-1),t.lastIndexOf("\xA0",e-1))+1,s=t.slice(i,e),r=o.linkRegExp.exec(s);if(r){let a=o.getSelection();o._docWasChanged(),o._recordUndoState(a),o._getRangeAndRemoveBookmark(a);let l=i+r.index,d=l+r[0].length,c=a.startContainer===n,u=a.startOffset-d;l&&(n=n.splitText(l));let f=o._config.tagAttributes.a,m=N("A",Object.assign({href:r[1]?/^(?:ht|f)tps?:/i.test(r[1])?r[1]:"http://"+r[1]:"mailto:"+r[0]},f));m.textContent=t.slice(l,d),n.parentNode.insertBefore(m,n),n.data=t.slice(d),c&&(a.setStart(n,u),a.setEnd(n,u)),o.setSelection(a)}};var Ge=(o,n,e)=>{let t=o._root;if(o._removeZWS(),o.saveUndoState(e),!e.collapsed)n.preventDefault(),P(e,t),oe(o,e);else if(V(e,t)){n.preventDefault();let i=L(e,t);if(!i)return;let s=i;A(s.parentNode,t);let r=G(s,t);if(r){if(!r.isContentEditable){pe(r,t);return}for(ee(r,s,e,t),s=r.parentNode;s!==t&&!s.nextSibling;)s=s.parentNode;s!==t&&(s=s.nextSibling)&&F(s,t),o.setSelection(e)}else if(s){if(S(s,t,"UL")||S(s,t,"OL")){o.decreaseListLevel(e);return}else if(S(s,t,"BLOCKQUOTE")){o.removeQuote(e);return}o.setSelection(e),o._updatePath(e,!0)}}else{C(e);let i=e.startContainer,s=e.startOffset,r=i.parentNode;i instanceof Text&&r instanceof HTMLAnchorElement&&s&&r.href.includes(i.data)?(i.deleteData(s-1,1),o.setSelection(e),o.removeLink(),n.preventDefault()):(o.setSelection(e),setTimeout(()=>{oe(o)},0))}};var Ze=(o,n,e)=>{let t=o._root,i,s,r,a,l,d;if(o._removeZWS(),o.saveUndoState(e),!e.collapsed)n.preventDefault(),P(e,t),oe(o,e);else if(j(e,t)){if(n.preventDefault(),i=L(e,t),!i)return;if(A(i.parentNode,t),s=K(i,t),s){if(!s.isContentEditable){pe(s,t);return}for(ee(i,s,e,t),s=i.parentNode;s!==t&&!s.nextSibling;)s=s.parentNode;s!==t&&(s=s.nextSibling)&&F(s,t),o.setSelection(e),o._updatePath(e,!0)}}else{if(r=e.cloneRange(),W(e,t,t,t),a=e.endContainer,l=e.endOffset,a instanceof Element&&(d=a.childNodes[l],d&&d.nodeName==="IMG")){n.preventDefault(),E(d),C(e),oe(o,e);return}o.setSelection(r),setTimeout(()=>{oe(o)},0)}};var je=(o,n,e)=>{let t=o._root;if(o._removeZWS(),e.collapsed&&V(e,t)){let i=L(e,t),s;for(;s=i.parentNode;){if(s.nodeName==="UL"||s.nodeName==="OL"){n.preventDefault(),o.increaseListLevel(e);break}i=s}}},Xe=(o,n,e)=>{let t=o._root;if(o._removeZWS(),e.collapsed&&V(e,t)){let i=e.startContainer;(S(i,t,"UL")||S(i,t,"OL"))&&(n.preventDefault(),o.decreaseListLevel(e))}};var Qe=(o,n,e)=>{var s;let t,i=o._root;if(o._recordUndoState(e),o._getRangeAndRemoveBookmark(e),!e.collapsed)P(e,i),o._ensureBottomLine(),o.setSelection(e),o._updatePath(e,!0);else if(j(e,i)){let r=L(e,i);if(r&&r.nodeName!=="PRE"){let a=(s=r.textContent)==null?void 0:s.trimEnd().replace(B,"");if(a==="*"||a==="1."){n.preventDefault(),o.insertPlainText(" ",!1),o._docWasChanged(),o.saveUndoState(e);let l=new x(r,4),d;for(;d=l.nextNode();)E(d);a==="*"?o.makeUnorderedList():o.makeOrderedList();return}}}if(t=e.endContainer,e.endOffset===y(t))do if(t.nodeName==="A"){e.setStartAfter(t);break}while(!t.nextSibling&&(t=t.parentNode)&&t!==i);if(o._config.addLinks){let r=e.cloneRange();C(r);let a=r.startContainer,l=r.startOffset;setTimeout(()=>{Ne(o,a,l)},0)}o.setSelection(e)};function $e(){let{isWin:o,ctrlKey:n,supportsInputEvents:e,isIOS:t,isMac:i}=Q(),s=function(l){if(l.defaultPrevented||l.isComposing||!this.getRoot().isContentEditable)return;let d=l.key,c="",u=l.code;/^Digit\d$/.test(u)&&(d=u.slice(-1)),d!=="Backspace"&&d!=="Delete"&&(l.altKey&&(c+="Alt-"),l.ctrlKey&&(c+="Ctrl-"),l.metaKey&&(c+="Meta-"),l.shiftKey&&(c+="Shift-")),o&&l.shiftKey&&d==="Delete"&&(c+="Shift-"),d=c+d;let f=this.getSelection();this._keyHandlers[d]?this._keyHandlers[d](this,l,f):!f.collapsed&&!l.ctrlKey&&!l.metaKey&&d.length===1&&(this.saveUndoState(f),P(f,this._root),this._ensureBottomLine(),this.setSelection(f),this._updatePath(f,!0))},r={Backspace:Ge,Delete:Ze,Tab:je,"Shift-Tab":Xe," ":Qe,ArrowLeft(l){l._removeZWS()},ArrowRight(l,d,c){l._removeZWS();let u=l.getRoot();if(j(c,u)){C(c);let f=c.endContainer;do if(f.nodeName==="CODE"){let m=f.nextSibling;if(!(m instanceof Text)){let p=document.createTextNode("\xA0");f.parentNode.insertBefore(p,m),m=p}c.setStart(m,1),l.setSelection(c),d.preventDefault();break}while(!f.nextSibling&&(f=f.parentNode)&&f!==u)}}};e||(r.Enter=ke,r["Shift-Enter"]=ke),!i&&!t&&(r.PageUp=l=>{l.moveCursorToStart()},r.PageDown=l=>{l.moveCursorToEnd()});let a=(l,d)=>(d=d||null,(c,u)=>{u.preventDefault();let f=c.getSelection();c.hasFormat(l,null,f)?c.changeFormat(null,{tag:l},f):c.changeFormat({tag:l},d,f)});return r[n+"b"]=a("B"),r[n+"i"]=a("I"),r[n+"u"]=a("U"),r[n+"Shift-7"]=a("S"),r[n+"Shift-5"]=a("SUB",{tag:"SUP"}),r[n+"Shift-6"]=a("SUP",{tag:"SUB"}),r[n+"Shift-8"]=(l,d)=>{d.preventDefault();let c=l.getPath();/(?:^|>)UL/.test(c)?l.removeList():l.makeUnorderedList()},r[n+"Shift-9"]=(l,d)=>{d.preventDefault();let c=l.getPath();/(?:^|>)OL/.test(c)?l.removeList():l.makeOrderedList()},r[n+"["]=(l,d)=>{d.preventDefault();let c=l.getPath();/(?:^|>)BLOCKQUOTE/.test(c)||!/(?:^|>)[OU]L/.test(c)?l.decreaseQuoteLevel():l.decreaseListLevel()},r[n+"]"]=(l,d)=>{d.preventDefault();let c=l.getPath();/(?:^|>)BLOCKQUOTE/.test(c)||!/(?:^|>)[OU]L/.test(c)?l.increaseQuoteLevel():l.increaseListLevel()},r[n+"d"]=(l,d)=>{d.preventDefault(),l.toggleCode()},r[n+"z"]=(l,d)=>{d.preventDefault(),l.undo()},r[n+"y"]=r[n+"Shift-z"]=r[n+"Shift-Z"]=(l,d)=>{d.preventDefault(),l.redo()},{_onKey:s,keyHandlers:r}}var ge=class{constructor(n,e){this.customEvents=new Set(["pathChange","select","input","pasteImage","undoStateChange","mutation"]);this.startSelectionId="squire-selection-start";this.endSelectionId="squire-selection-end";this.linkRegExp=/\b(?:((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.]|[a-z0-9][a-z0-9.\-]*[.][a-z]{2,}\/)(?:[^\s()<>]+|\([^\s()<>]+\))+(?:[^\s?&`!()\[\]{};:'".,<>«»“”‘’]|\([^\s()<>]+\)))|([\w\-.%+]+@(?:[\w\-]+\.)+[a-z]{2,}\b(?:[?][^&?\s]+=[^\s?&`!()\[\]{};:'".,<>«»“”‘’]+(?:&[^&?\s]+=[^\s?&`!()\[\]{};:'".,<>«»“”‘’]+)*)?))/i;this.tagAfterSplit={DT:"DD",DD:"DT",LI:"LI",PRE:"PRE"};this._root=n,this._config=this._makeConfig(e),this._isFocused=!1,this._lastSelection=Y(n,0),this._willRestoreSelection=!1,this._mayHaveZWS=!1,this._lastAnchorNode=null,this._lastFocusNode=null,this._path="",this._events=new Map,this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0,this._isInUndoState=!1,this._ignoreChange=!1,this._ignoreAllChanges=!1,this.addEventListener("selectionchange",this._updatePathOnEvent),this.addEventListener("blur",this._enableRestoreSelection),this.addEventListener("mousedown",this._disableRestoreSelection),this.addEventListener("touchstart",this._disableRestoreSelection),this.addEventListener("focus",this._restoreSelection),this.addEventListener("blur",this._removeZWS),this._isShiftDown=!1,this.addEventListener("cut",Ue),this.addEventListener("copy",We),this.addEventListener("paste",Ke),this.addEventListener("drop",ze),this.addEventListener("keydown",Oe),this.addEventListener("keyup",Oe);let{_onKey:t,keyHandlers:i}=$e();this.addEventListener("keydown",t),this._keyHandlers=Object.create(i);let s=new MutationObserver(r=>{this._handleMutationChanges(r)});s.observe(n,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._mutation=s,n.setAttribute("contenteditable","true"),this.addEventListener("beforeinput",this._beforeInput),this.setHTML("")}destroy(){this._events.forEach((n,e)=>{this.removeEventListener(e)}),this._mutation.disconnect(),this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0}_makeConfig(n){let e={blockTag:"DIV",blockAttributes:null,tagAttributes:{},ignoreRootAttributes:!1,classNames:{color:"color",fontFamily:"font",fontSize:"size",highlight:"highlight",align:"align"},undo:{documentSizeThreshold:-1,undoLimit:-1},addLinks:!0,willCutCopy:null,toPlainText:null,sanitizeToDOMFragment:t=>{let i=DOMPurify.sanitize(t,{ALLOW_UNKNOWN_PROTOCOLS:!0,WHOLE_DOCUMENT:!1,RETURN_DOM:!0,RETURN_DOM_FRAGMENT:!0,FORCE_BODY:!1});return i?document.importNode(i,!0):document.createDocumentFragment()},didError:t=>console.log(t)};return n&&(Object.assign(e,n),e.blockTag=e.blockTag.toUpperCase()),e}setKeyHandler(n,e){return this._keyHandlers[n]=e,this}_beforeInput(n){switch(n.inputType){case"insertLineBreak":n.preventDefault(),this.splitBlock(!0);break;case"insertParagraph":n.preventDefault(),this.splitBlock(!1);break;case"insertOrderedList":n.preventDefault(),this.makeOrderedList();break;case"insertUnoderedList":n.preventDefault(),this.makeUnorderedList();break;case"historyUndo":n.preventDefault(),this.undo();break;case"historyRedo":n.preventDefault(),this.redo();break;case"formatBold":n.preventDefault(),this.bold();break;case"formaItalic":n.preventDefault(),this.italic();break;case"formatUnderline":n.preventDefault(),this.underline();break;case"formatStrikeThrough":n.preventDefault(),this.strikethrough();break;case"formatSuperscript":n.preventDefault(),this.superscript();break;case"formatSubscript":n.preventDefault(),this.subscript();break;case"formatJustifyFull":case"formatJustifyCenter":case"formatJustifyRight":case"formatJustifyLeft":{n.preventDefault();let e=n.inputType.slice(13).toLowerCase();e==="full"&&(e="justify"),this.setTextAlignment(e);break}case"formatRemove":n.preventDefault(),this.removeAllFormatting();break;case"formatSetBlockTextDirection":{n.preventDefault();let e=n.data;e==="null"&&(e=null),this.setTextDirection(e);break}case"formatBackColor":n.preventDefault(),this.setHighlightColor(n.data);break;case"formatFontColor":n.preventDefault(),this.setTextColor(n.data);break;case"formatFontName":n.preventDefault(),this.setFontFace(n.data);break}}handleEvent(n){this.fireEvent(n.type,n)}fireEvent(n,e){let t=this._events.get(n);if(/^(?:focus|blur)/.test(n)){let i=this._root===document.activeElement;if(n==="focus"){if(!i||this._isFocused)return this;this._isFocused=!0}else{if(i||!this._isFocused)return this;this._isFocused=!1}}if(t){let i=e instanceof Event?e:new CustomEvent(n,{detail:e});t=t.slice();for(let s of t)try{"handleEvent"in s?s.handleEvent(i):s.call(this,i)}catch(r){this._config.didError(r)}}return this}addEventListener(n,e){let t=this._events.get(n),i=this._root;return t||(t=[],this._events.set(n,t),this.customEvents.has(n)||(n==="selectionchange"&&(i=document),i.addEventListener(n,this,!0))),t.push(e),this}removeEventListener(n,e){let t=this._events.get(n),i=this._root;if(t){if(e){let s=t.length;for(;s--;)t[s]===e&&t.splice(s,1)}else t.length=0;t.length||(this._events.delete(n),this.customEvents.has(n)||(n==="selectionchange"&&(i=document),i.removeEventListener(n,this,!0)))}return this}focus(){return this._root.focus({preventScroll:!0}),this}blur(){return this._root.blur(),this}_enableRestoreSelection(){this._willRestoreSelection=!0}_disableRestoreSelection(){this._willRestoreSelection=!1}_restoreSelection(){this._willRestoreSelection&&this.setSelection(this._lastSelection)}_removeZWS(){this._mayHaveZWS&&(ie(this._root),this._mayHaveZWS=!1)}_saveRangeToBookmark(n){let e=N("INPUT",{id:this.startSelectionId,type:"hidden"}),t=N("INPUT",{id:this.endSelectionId,type:"hidden"}),i;X(n,e),n.collapse(!1),X(n,t),e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING&&(e.id=this.endSelectionId,t.id=this.startSelectionId,i=e,e=t,t=i),n.setStartAfter(e),n.setEndBefore(t)}_getRangeAndRemoveBookmark(n){let e=this._root,t=e.querySelector("#"+this.startSelectionId),i=e.querySelector("#"+this.endSelectionId);if(t&&i){let s=t.parentNode,r=i.parentNode,a=Array.from(s.childNodes).indexOf(t),l=Array.from(r.childNodes).indexOf(i);s===r&&(l-=1),t.remove(),i.remove(),n||(n=document.createRange()),n.setStart(s,a),n.setEnd(r,l),ne(s,n),s!==r&&ne(r,n),n.collapsed&&(s=n.startContainer,s instanceof Text&&(r=s.childNodes[n.startOffset],(!r||!(r instanceof Text))&&(r=s.childNodes[n.startOffset-1]),r&&r instanceof Text&&(n.setStart(r,0),n.collapse(!0))))}return n||null}getSelection(){let n=window.getSelection(),e=this._root,t=null;if(this._isFocused&&n&&n.rangeCount){t=n.getRangeAt(0).cloneRange();let i=t.startContainer,s=t.endContainer;i&&H(i)&&t.setStartBefore(i),s&&H(s)&&t.setEndBefore(s)}return t&&e.contains(t.commonAncestorContainer)?this._lastSelection=t:(t=this._lastSelection,document.contains(t.commonAncestorContainer)||(t=null)),t||(t=Y(e.firstElementChild||e,0)),t}setSelection(n){if(this._lastSelection=n,!this._isFocused)this._enableRestoreSelection();else{let e=("getSelection"in document?document:window).getSelection();e&&("setBaseAndExtent"in Selection.prototype?e.setBaseAndExtent(n.startContainer,n.startOffset,n.endContainer,n.endOffset):(e.removeAllRanges(),e.addRange(n)))}return this}_moveCursorTo(n){let e=this._root,t=Y(e,n?0:e.childNodes.length);return C(t),this.setSelection(t),this}moveCursorToStart(){return this._moveCursorTo(!0)}moveCursorToEnd(){return this._moveCursorTo(!1)}getCursorPosition(){let n=this.getSelection(),e=n.getBoundingClientRect();if(e&&!e.top){this._ignoreChange=!0;let t=N("SPAN");t.textContent=B,X(n,t),e=t.getBoundingClientRect();let i=t.parentNode;i.removeChild(t),ne(i,n)}return e}getPath(){return this._path}_updatePathOnEvent(){this._isFocused&&this._updatePath(this.getSelection())}_updatePath(n,e){let t=n.startContainer,i=n.endContainer,s;(e||t!==this._lastAnchorNode||i!==this._lastFocusNode)&&(this._lastAnchorNode=t,this._lastFocusNode=i,s=t&&i?t===i?this._getPath(i):"(selection)":"",(this._path!==s||t!==i)&&(this._path=s,this.fireEvent("pathChange",{path:s}))),this.fireEvent(n.collapsed?"cursor":"select",{range:n})}_getPath(n){let e=this._root,t=this._config,i="";if(n&&n!==e){let s=n.parentNode;if(i=s?this._getPath(s):"",n instanceof HTMLElement){let r=n.id,a=n.classList,l=Array.from(a).sort(),d=n.dir,c=t.classNames;i+=(i?">":"")+n.nodeName,r&&(i+="#"+r),l.length&&(i+=".",i+=l.join(".")),d&&(i+="[dir="+d+"]"),a.contains(c.highlight)&&(i+="[backgroundColor="+n.style.backgroundColor.replace(/ /g,"")+"]"),a.contains(c.color)&&(i+="[color="+n.style.color.replace(/ /g,"")+"]"),a.contains(c.fontFamily)&&(i+="[fontFamily="+n.style.fontFamily.replace(/ /g,"")+"]"),a.contains(c.fontSize)&&(i+="[fontSize="+n.style.fontSize+"]")}}return i}modifyDocument(n){return this.unobserve(),n(),this.observe(),this}unobserve(){let n=this._mutation;if(n){let e=n.takeRecords();e.length&&this._handleMutationChanges(e),n.disconnect()}return this._ignoreAllChanges=!0,this}observe(){let n=this._mutation;return this._ignoreAllChanges=!1,n&&(n.observe(this._root,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._ignoreChange=!1),this}_docWasChanged(){if(we(),this._mayHaveZWS=!0,!(!this.getRoot().isContentEditable||this._ignoreAllChanges)){if(this._ignoreChange){this._ignoreChange=!1;return}this._isInUndoState&&(this._isInUndoState=!1,this.fireEvent("undoStateChange",{canUndo:!0,canRedo:!1})),this.fireEvent("input")}}_handleMutationChanges(n){this.fireEvent("mutation",{records:n}),(!n.length||!this._config.ignoreRootAttributes||n.some(e=>e.type!=="attributes"&&e.target!==this.getRoot()))&&this._docWasChanged()}_recordUndoState(n,e){let t=this._isInUndoState;if(!t||e){let i=this._undoIndex+1,s=this._undoStack,r=this._config.undo,a=r.documentSizeThreshold,l=r.undoLimit;if(i<this._undoStackLength&&(s.length=this._undoStackLength=i),n&&this._saveRangeToBookmark(n),t)return this;let d=this._getRawHTML();e&&(i-=1),a>-1&&d.length*2>a&&l>-1&&i>l&&(s.splice(0,i-l),i=l,this._undoStackLength=l),s[i]=d,this._undoIndex=i,this._undoStackLength+=1,this._isInUndoState=!0}return this}saveUndoState(n){return n||(n=this.getSelection()),this._recordUndoState(n,this._isInUndoState),this._getRangeAndRemoveBookmark(n),this}undo(){if(this._undoIndex!==0||!this._isInUndoState){this._recordUndoState(this.getSelection(),!1),this._undoIndex-=1,this._setRawHTML(this._undoStack[this._undoIndex]);let n=this._getRangeAndRemoveBookmark();n&&this.setSelection(n),this._isInUndoState=!0,this.fireEvent("undoStateChange",{canUndo:this._undoIndex!==0,canRedo:!0}),this.fireEvent("input")}return this.focus()}redo(){let n=this._undoIndex,e=this._undoStackLength;if(n+1<e&&this._isInUndoState){this._undoIndex+=1,this._setRawHTML(this._undoStack[this._undoIndex]);let t=this._getRangeAndRemoveBookmark();t&&this.setSelection(t),this.fireEvent("undoStateChange",{canUndo:!0,canRedo:n+2<e}),this.fireEvent("input")}return this.focus()}getRoot(){return this._root}_getRawHTML(){return this._root.innerHTML}_setRawHTML(n){let e=this._root;e.innerHTML=n;let t=e,i=t.firstChild;if(!i||i.nodeName==="BR"){let s=this.createDefaultBlock();i?t.replaceChild(s,i):t.appendChild(s)}else for(;t=K(t,e);)v(t);return this._ignoreChange=!0,this}getHTML(n){let e;n&&(e=this.getSelection(),this._saveRangeToBookmark(e));let t=this._getRawHTML().replace(/\u200B/g,"");return n&&this._getRangeAndRemoveBookmark(e),t}setHTML(n){let e=this._config.sanitizeToDOMFragment(n,this),t=this._root;ue(e,this._config),se(e,t,!1),A(e,t);let i=e,s=i.firstChild;if(!s||s.nodeName==="BR"){let r=this.createDefaultBlock();s?i.replaceChild(r,s):i.appendChild(r)}else for(;i=K(i,t);)v(i);for(this._ignoreChange=!0;s=t.lastChild;)t.removeChild(s);return t.appendChild(e),this.clearUndoStack(),this}clearUndoStack(){this._undoIndex=-1,this._undoStack.length=0,this._undoStackLength=0,this._isInUndoState=!1;let n=this.getRoot(),e=this._getRangeAndRemoveBookmark()||Y(n.firstElementChild||n,0);this.saveUndoState(e),this.setSelection(e),this._updatePath(e,!0),this.fireEvent("undoStateChange",{canUndo:!1,canRedo:!1})}insertHTML(n,e){let t=this._config,i=t.sanitizeToDOMFragment(n,this),s=this.getSelection();this.saveUndoState(s);try{let r=this._root;t.addLinks&&this.addDetectedLinks(i,i),ue(i,this._config),se(i,r,!1),he(i),i.normalize();let a=i;for(;a=K(a,i);)v(a);let l=!0;if(e){let d=new CustomEvent("willPaste",{cancelable:!0,detail:{html:n,fragment:i}});this.fireEvent("willPaste",d),i=d.detail.fragment,l=!d.defaultPrevented}l&&(Pe(s,i,r),s.collapse(!1),_e(s,"A",r),this._ensureBottomLine()),this.setSelection(s),this._updatePath(s,!0),e&&this.focus()}catch(r){this._config.didError(r)}return this}insertElement(n,e){if(e||(e=this.getSelection()),e.collapse(!0),g(n))X(e,n),e.setStartAfter(n);else{let t=this._root,i=L(e,t),s=i||t,r=null;for(;s!==t&&!s.nextSibling;)s=s.parentNode;if(s!==t){let l=s.parentNode;r=w(l,s.nextSibling,t,t)}i&&le(i)&&E(i),t.insertBefore(n,r);let a=this.createDefaultBlock();t.insertBefore(a,r),e.setStart(a,0),e.setEnd(a,0),C(e)}return this.focus(),this.setSelection(e),this._updatePath(e),this}insertImage(n,e){let t=N("IMG",Object.assign({src:n},e));return this.insertElement(t),t}insertPlainText(n,e){let t=this.getSelection();if(t.collapsed&&S(t.startContainer,this._root,"PRE")){let c=t.startContainer,u=t.startOffset,f;if(!c||!(c instanceof Text)){let p=document.createTextNode("");c.insertBefore(p,c.childNodes[u]),f=p,u=0}else f=c;let m=!0;if(e){let p=new CustomEvent("willPaste",{cancelable:!0,detail:{text:n}});this.fireEvent("willPaste",p),n=p.detail.text,m=!p.defaultPrevented}return m&&(f.insertData(u,n),t.setStart(f,u+n.length),t.collapse(!0)),this.setSelection(t),this}let i=n.split(`
`),s=this._config,r=s.blockTag,a=s.blockAttributes,l="</"+r+">",d="<"+r;for(let c in a)d+=" "+c+'="'+ve(a[c])+'"';d+=">";for(let c=0,u=i.length;c<u;c+=1){let f=i[c];f=ve(f).replace(/ (?=(?: |$))/g,"&nbsp;"),c&&(f=d+(f||"<BR>")+l),i[c]=f}return this.insertHTML(i.join(""),e)}getSelectedText(n){return me(n||this.getSelection())}getFontInfo(n){let e={color:void 0,backgroundColor:void 0,fontFamily:void 0,fontSize:void 0};n||(n=this.getSelection()),C(n);let t=0,i=n.commonAncestorContainer;if(n.collapsed||i instanceof Text)for(i instanceof Text&&(i=i.parentNode);t<4&&i;){let s=i.style;if(s){let r=s.color;!e.color&&r&&(e.color=r,t+=1);let a=s.backgroundColor;!e.backgroundColor&&a&&(e.backgroundColor=a,t+=1);let l=s.fontFamily;!e.fontFamily&&l&&(e.fontFamily=l,t+=1);let d=s.fontSize;!e.fontSize&&d&&(e.fontSize=d,t+=1)}i=i.parentNode}return e}hasFormat(n,e,t){n=n.toUpperCase(),e||(e={}),t||(t=this.getSelection()),!t.collapsed&&t.startContainer instanceof Text&&t.startOffset===t.startContainer.length&&t.startContainer.nextSibling&&t.setStartBefore(t.startContainer.nextSibling),!t.collapsed&&t.endContainer instanceof Text&&t.endOffset===0&&t.endContainer.previousSibling&&t.setEndAfter(t.endContainer.previousSibling);let i=this._root,s=t.commonAncestorContainer;if(S(s,i,n,e))return!0;if(s instanceof Text)return!1;let r=new x(s,4,d=>z(t,d,!0)),a=!1,l;for(;l=r.nextNode();){if(!S(l,i,n,e))return!1;a=!0}return a}changeFormat(n,e,t,i){return t||(t=this.getSelection()),this.saveUndoState(t),e&&(t=this._removeFormat(e.tag.toUpperCase(),e.attributes||{},t,i)),n&&(t=this._addFormat(n.tag.toUpperCase(),n.attributes||{},t)),this.setSelection(t),this._updatePath(t,!0),this.focus()}_addFormat(n,e,t){let i=this._root;if(t.collapsed){let s=v(N(n,e));X(t,s);let r=s.firstChild||s,a=r instanceof Text?r.length:0;t.setStart(r,a),t.collapse(!0);let l=s;for(;g(l);)l=l.parentNode;ie(l,s)}else{let s=new x(t.commonAncestorContainer,5,c=>(c instanceof Text||c.nodeName==="BR"||c.nodeName==="IMG")&&z(t,c,!0)),{startContainer:r,startOffset:a,endContainer:l,endOffset:d}=t;if(s.currentNode=r,!(r instanceof Element)&&!(r instanceof Text)||!s.filter(r)){let c=s.nextNode();if(!c)return t;r=c,a=0}do{let c=s.currentNode;if(!S(c,i,n,e)){c===l&&c.length>d&&c.splitText(d),c===r&&a&&(c=c.splitText(a),l===r?(l=c,d-=a):l===r.parentNode&&(d+=1),r=c,a=0);let f=N(n,e);O(c,f),f.appendChild(c)}}while(s.nextNode());t=Y(r,a,l,d)}return t}_removeFormat(n,e,t,i){let{cantFocusEmptyTextNodes:s}=Q();this._saveRangeToBookmark(t);let r;t.collapsed&&(s?r=document.createTextNode(B):r=document.createTextNode(""),X(t,r));let a=t.commonAncestorContainer;for(;g(a);)a=a.parentNode;let l=t.startContainer,d=t.startOffset,c=t.endContainer,u=t.endOffset,f=[],m=(h,b)=>{if(z(t,h,!1))return;let _,k;if(!z(t,h,!0)){!(h instanceof HTMLInputElement)&&(!(h instanceof Text)||h.data)&&f.push([b,h]);return}if(h instanceof Text)h===c&&u!==h.length&&f.push([b,h.splitText(u)]),h===l&&d&&(h.splitText(d),f.push([b,h]));else for(_=h.firstChild;_;_=k)k=_.nextSibling,m(_,b)},p=Array.from(a.getElementsByTagName(n)).filter(h=>z(t,h,!0)&&ce(h,n,e));if(i||p.forEach(h=>{m(h,h)}),f.forEach(([h,b])=>{h=h.cloneNode(!1),O(b,h),h.appendChild(b)}),p.forEach(h=>{O(h,T(h))}),s&&r){r=r.parentNode;let h=r;for(;h&&g(h);)h=h.parentNode;h&&ie(h,r)}return this._getRangeAndRemoveBookmark(t),r&&t.collapse(!1),ne(a,t),t}bold(){return this.changeFormat({tag:"B"})}removeBold(){return this.changeFormat(null,{tag:"B"})}italic(){return this.changeFormat({tag:"I"})}removeItalic(){return this.changeFormat(null,{tag:"I"})}underline(){return this.changeFormat({tag:"U"})}removeUnderline(){return this.changeFormat(null,{tag:"U"})}strikethrough(){return this.changeFormat({tag:"S"})}removeStrikethrough(){return this.changeFormat(null,{tag:"S"})}subscript(){return this.changeFormat({tag:"SUB"},{tag:"SUP"})}removeSubscript(){return this.changeFormat(null,{tag:"SUB"})}superscript(){return this.changeFormat({tag:"SUP"},{tag:"SUB"})}removeSuperscript(){return this.changeFormat(null,{tag:"SUP"})}makeLink(n,e){let t=this.getSelection();if(t.collapsed){let i=n.indexOf(":")+1;if(i)for(;n[i]==="/";)i+=1;X(t,document.createTextNode(n.slice(i)))}return e=Object.assign({href:n},this._config.tagAttributes.a,e),this.changeFormat({tag:"A",attributes:e},{tag:"A"},t)}removeLink(){return this.changeFormat(null,{tag:"A"},this.getSelection(),!0)}addDetectedLinks(n,e){let t=new x(n,4,a=>!S(a,e||this._root,"A")),i=this.linkRegExp,s=this._config.tagAttributes.a,r;for(;r=t.nextNode();){let a=r.parentNode,l=r.data,d;for(;d=i.exec(l);){let c=d.index,u=c+d[0].length;c&&a.insertBefore(document.createTextNode(l.slice(0,c)),r);let f=N("A",Object.assign({href:d[1]?/^(?:ht|f)tps?:/i.test(d[1])?d[1]:"http://"+d[1]:"mailto:"+d[0]},s));f.textContent=l.slice(c,u),a.insertBefore(f,r),r.data=l=l.slice(u)}}return this}setFontFace(n){let e=this._config.classNames.fontFamily;return this.changeFormat(n?{tag:"SPAN",attributes:{class:e,style:"font-family: "+n+", sans-serif;"}}:null,{tag:"SPAN",attributes:{class:e}})}setFontSize(n){let e=this._config.classNames.fontSize;return this.changeFormat(n?{tag:"SPAN",attributes:{class:e,style:"font-size: "+(typeof n=="number"?n+"px":n)}}:null,{tag:"SPAN",attributes:{class:e}})}setTextColor(n){let e=this._config.classNames.color;return this.changeFormat(n?{tag:"SPAN",attributes:{class:e,style:"color:"+n}}:null,{tag:"SPAN",attributes:{class:e}})}setHighlightColor(n){let e=this._config.classNames.highlight;return this.changeFormat(n?{tag:"SPAN",attributes:{class:e,style:"background-color:"+n}}:null,{tag:"SPAN",attributes:{class:e}})}_ensureBottomLine(){let n=this._root,e=n.lastElementChild;(!e||e.nodeName!==this._config.blockTag||!q(e))&&n.appendChild(this.createDefaultBlock())}createDefaultBlock(n){let e=this._config;return v(N(e.blockTag,e.blockAttributes,n))}splitBlock(n,e){e||(e=this.getSelection());let t=this._root,i,s,r,a;if(this._recordUndoState(e),this._removeZWS(),this._getRangeAndRemoveBookmark(e),e.collapsed||P(e,t),this._config.addLinks){C(e);let f=e.startContainer,m=e.startOffset;setTimeout(()=>{Ne(this,f,m)},0)}if(i=L(e,t),i&&(s=S(i,t,"PRE"))){C(e),r=e.startContainer;let f=e.startOffset;return r instanceof Text||(r=document.createTextNode(""),s.insertBefore(r,s.firstChild)),!n&&r instanceof Text&&(r.data.charAt(f-1)===`
`||V(e,t))&&(r.data.charAt(f)===`
`||j(e,t))?(r.deleteData(f&&f-1,f?2:1),a=w(r,f&&f-1,t,t),r=a.previousSibling,r.textContent||E(r),r=this.createDefaultBlock(),a.parentNode.insertBefore(r,a),a.textContent||E(a),e.setStart(r,0)):(r.insertData(f,`
`),v(s),r.length===f+1?e.setStartAfter(r):e.setStart(r,f+1)),e.collapse(!0),this.setSelection(e),this._updatePath(e,!0),this._docWasChanged(),this}if(!i||n||/^T[HD]$/.test(i.nodeName))return _e(e,"A",t),X(e,N("BR")),e.collapse(!1),this.setSelection(e),this._updatePath(e,!0),this;if((s=S(i,t,"LI"))&&(i=s),le(i)){if(S(i,t,"UL")||S(i,t,"OL"))return this.decreaseListLevel(e),this;if(S(i,t,"BLOCKQUOTE"))return this.replaceWithBlankLine(e),this}r=e.startContainer;let l=e.startOffset,d=this.tagAfterSplit[i.nodeName];a=w(r,l,i.parentNode,this._root);let c=this._config,u=null;for(d||(d=c.blockTag,u=c.blockAttributes),ce(a,d,u)||(i=N(d,u),a.dir&&(i.dir=a.dir),O(a,i),i.appendChild(T(a)),a=i),ie(i),he(i),v(i);a instanceof Element;){let f=a.firstChild,m;if(a.nodeName==="A"&&(!a.textContent||a.textContent===B)){f=document.createTextNode(""),O(a,f),a=f;break}for(;f&&f instanceof Text&&!f.data&&(m=f.nextSibling,!(!m||m.nodeName==="BR"));)E(f),f=m;if(!f||f.nodeName==="BR"||f instanceof Text)break;a=f}return e=Y(a,0),this.setSelection(e),this._updatePath(e,!0),this}forEachBlock(n,e,t){t||(t=this.getSelection()),e&&this.saveUndoState(t);let i=this._root,s=L(t,i),r=Z(t,i);if(s&&r)do if(n(s)||s===r)break;while(s=K(s,i));return e&&(this.setSelection(t),this._updatePath(t,!0)),this}modifyBlocks(n,e){e||(e=this.getSelection()),this._recordUndoState(e,this._isInUndoState);let t=this._root;be(e,t),W(e,t,t,t);let i=Le(e,t,t);if(!e.collapsed){let s=e.endContainer;if(s===t)e.collapse(!1);else{for(;s.parentNode!==t;)s=s.parentNode;e.setStartBefore(s),e.collapse(!0)}}return X(e,n.call(this,i)),e.endOffset<e.endContainer.childNodes.length&&F(e.endContainer.childNodes[e.endOffset],t),F(e.startContainer.childNodes[e.startOffset],t),this._getRangeAndRemoveBookmark(e),this.setSelection(e),this._updatePath(e,!0),this}setTextAlignment(n){let{align:e}=this._config.classNames,t=["left","right","center","justify"].includes(n);return this.forEachBlock(i=>{let s=i.className.split(/\s+/).filter(r=>!!r&&!(r!=null&&r.startsWith(e))).join(" ");t?(i.className=(s?s+" ":"")+e+"-"+n,i.style.textAlign=n):(i.className=s,i.style.textAlign="")},!0),this.focus()}setTextDirection(n){return this.forEachBlock(e=>{n?e.dir=n:e.removeAttribute("dir")},!0),this.focus()}_getListSelection(n,e){let t=n.commonAncestorContainer,i=n.startContainer,s=n.endContainer;for(;t&&t!==e&&!/^[OU]L$/.test(t.nodeName);)t=t.parentNode;if(!t||t===e)return null;for(i===t&&(i=i.childNodes[n.startOffset]),s===t&&(s=s.childNodes[n.endOffset]);i&&i.parentNode!==t;)i=i.parentNode;for(;s&&s.parentNode!==t;)s=s.parentNode;return[t,i,s]}increaseListLevel(n){n||(n=this.getSelection());let e=this._root,t=this._getListSelection(n,e);if(!t)return this.focus();let[i,s,r]=t;if(!s||s===i.firstChild)return this.focus();this._recordUndoState(n,this._isInUndoState);let a=i.nodeName,l=s.previousSibling,d,c;l.nodeName!==a&&(d=this._config.tagAttributes[a.toLowerCase()],l=N(a,d),i.insertBefore(l,s));do c=s===r?null:s.nextSibling,l.appendChild(s);while(s=c);return c=l.nextSibling,c&&F(c,e),this._getRangeAndRemoveBookmark(n),this.setSelection(n),this._updatePath(n,!0),this.focus()}decreaseListLevel(n){n||(n=this.getSelection());let e=this._root,t=this._getListSelection(n,e);if(!t)return this.focus();let[i,s,r]=t;s||(s=i.firstChild),r||(r=i.lastChild),this._recordUndoState(n,this._isInUndoState);let a,l=null;if(s){let d=i.parentNode;if(l=r.nextSibling?w(i,r.nextSibling,d,e):i.nextSibling,d!==e&&d.nodeName==="LI"){for(d=d.parentNode;l;)a=l.nextSibling,r.appendChild(l),l=a;l=i.parentNode.nextSibling}let c=!/^[OU]L$/.test(d.nodeName);do a=s===r?null:s.nextSibling,i.removeChild(s),c&&s.nodeName==="LI"&&(s=this.createDefaultBlock([T(s)])),d.insertBefore(s,l);while(s=a)}return i.firstChild||E(i),l&&F(l,e),this._getRangeAndRemoveBookmark(n),this.setSelection(n),this._updatePath(n,!0),this.focus()}_makeList(n,e){let t=re(n,this._root),i=this._config.tagAttributes,s=i[e.toLowerCase()],r=i.li,a;for(;a=t.nextNode();)if(a.parentNode instanceof HTMLLIElement&&(a=a.parentNode,t.currentNode=a.lastChild),a instanceof HTMLLIElement){a=a.parentNode;let l=a.nodeName;l!==e&&/^[OU]L$/.test(l)&&O(a,N(e,s,[T(a)]))}else{let l=N("LI",r);a.dir&&(l.dir=a.dir);let d=a.previousSibling;d&&d.nodeName===e?(d.appendChild(l),E(a)):O(a,N(e,s,[l])),l.appendChild(T(a)),t.currentNode=l}return n}makeUnorderedList(){return this.modifyBlocks(n=>this._makeList(n,"UL")),this.focus()}makeOrderedList(){return this.modifyBlocks(n=>this._makeList(n,"OL")),this.focus()}removeList(){return this.modifyBlocks(n=>{let e=n.querySelectorAll("UL, OL"),t=n.querySelectorAll("LI"),i=this._root;for(let s=0,r=e.length;s<r;s+=1){let a=e[s],l=T(a);A(l,i),O(a,l)}for(let s=0,r=t.length;s<r;s+=1){let a=t[s];q(a)?O(a,this.createDefaultBlock([T(a)])):(A(a,i),O(a,T(a)))}return n}),this.focus()}increaseQuoteLevel(n){return this.modifyBlocks(e=>N("BLOCKQUOTE",this._config.tagAttributes.blockquote,[e]),n),this.focus()}decreaseQuoteLevel(n){return this.modifyBlocks(e=>(Array.from(e.querySelectorAll("blockquote")).filter(t=>!S(t.parentNode,e,"BLOCKQUOTE")).forEach(t=>{O(t,T(t))}),e),n),this.focus()}removeQuote(n){return this.modifyBlocks(e=>(Array.from(e.querySelectorAll("blockquote")).forEach(t=>{O(t,T(t))}),e),n),this.focus()}replaceWithBlankLine(n){return this.modifyBlocks(()=>this.createDefaultBlock([N("INPUT",{id:this.startSelectionId,type:"hidden"}),N("INPUT",{id:this.endSelectionId,type:"hidden"})]),n),this.focus()}code(){let n=this.getSelection();return n.collapsed||$(n.commonAncestorContainer)?(this.modifyBlocks(e=>{let t=this._root,i=document.createDocumentFragment(),s=re(e,t),r;for(;r=s.nextNode();){let l=r.querySelectorAll("BR"),d=[],c=l.length;for(let u=0;u<c;u+=1)d[u]=te(l[u],!1);for(;c--;){let u=l[c];d[c]?O(u,document.createTextNode(`
`)):E(u)}for(l=r.querySelectorAll("CODE"),c=l.length;c--;)O(l[c],T(l[c]));i.childNodes.length&&i.appendChild(document.createTextNode(`
`)),i.appendChild(T(r))}let a=new x(i,4);for(;r=a.nextNode();)r.data=r.data.replace(/ /g," ");return i.normalize(),v(N("PRE",this._config.tagAttributes.pre,[i]))},n),this.focus()):this.changeFormat({tag:"CODE",attributes:this._config.tagAttributes.code},null,n),this}removeCode(){let n=this.getSelection(),e=n.commonAncestorContainer;return S(e,this._root,"PRE")?(this.modifyBlocks(i=>{let s=this._root,r=i.querySelectorAll("PRE"),a=r.length;for(;a--;){let l=r[a],d=new x(l,4),c;for(;c=d.nextNode();){let u=c.data;u=u.replace(/ (?= )/g,"\xA0");let f=document.createDocumentFragment(),m;for(;(m=u.indexOf(`
`))>-1;)f.appendChild(document.createTextNode(u.slice(0,m))),f.appendChild(N("BR")),u=u.slice(m+1);c.parentNode.insertBefore(f,c),c.data=u}A(l,s),O(l,T(l))}return i},n),this.focus()):this.changeFormat(null,{tag:"CODE"},n),this}toggleCode(){return this.hasFormat("PRE")||this.hasFormat("CODE")?this.removeCode():this.code(),this}_removeFormatting(n,e){for(let t=n.firstChild,i;t;t=i){if(i=t.nextSibling,g(t)){if(t instanceof Text||t.nodeName==="BR"||t.nodeName==="IMG"){e.appendChild(t);continue}}else if(q(t)){e.appendChild(this.createDefaultBlock([this._removeFormatting(t,document.createDocumentFragment())]));continue}this._removeFormatting(t,e)}return e}removeAllFormatting(n){if(n||(n=this.getSelection()),n.collapsed)return this.focus();let e=this._root,t=n.commonAncestorContainer;for(;t&&!q(t);)t=t.parentNode;if(t||(be(n,e),t=e),t instanceof Text)return this.focus();this.saveUndoState(n),W(n,t,t,e);let i=n.startContainer,s=n.startOffset,r=n.endContainer,a=n.endOffset,l=document.createDocumentFragment(),d=document.createDocumentFragment(),c=w(r,a,t,e),u=w(i,s,t,e),f;for(;u!==c;)f=u.nextSibling,l.appendChild(u),u=f;if(this._removeFormatting(l,d),d.normalize(),u=d.firstChild,f=d.lastChild,u){t.insertBefore(d,c);let m=Array.from(t.childNodes);s=m.indexOf(u),a=f?m.indexOf(f)+1:0}else c&&(s=Array.from(t.childNodes).indexOf(c),a=s);return n.setStart(t,s),n.setEnd(t,a),ne(t,n),C(n),this.setSelection(n),this._updatePath(n,!0),this.focus()}};window.Squire=ge;})();
//# sourceMappingURL=squire.js.map
